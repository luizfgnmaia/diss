options(OutDec = ",")
library(dplyr)
library(ggplot2)
load("data/gols.RData")
load("data/resultados.RData")
load("data/reds.RData")
resultados = resultados %>%
filter(Ano >= 2014, Campeonato == "Campeonato Brasileiro Série A")
gols = gols %>%
filter(Ano >= 2014, Campeonato == "Campeonato Brasileiro Série A")
reds = reds %>%
filter(Campeonato == "Campeonato Brasileiro Série A")
gols$Acréscimo[which(is.na(gols$Acréscimo))] = 0
gols = gols %>%
mutate(Minuto = Minuto + Acréscimo)
gols$Minuto[which(gols$Minuto > 50)] = 50
gols %>%
count(Minuto, Tempo) %>%
mutate(p = n/nrow(gols)) %>%
ggplot(aes(x = Minuto, y = p, col = Tempo)) +
geom_line(size = 1) +
geom_point(size = 2) +
theme_bw() +
ylab("Gols (%)") +
scale_x_continuous(breaks = seq(from = 0, to = 50, by = 5),
labels = c(seq(from = 0, to = 45, by = 5), "50+"))
resultados %>%
count(Placar_1, Placar_2) %>%
arrange(desc(n))
mandante = resultados %>%
count(Placar_1) %>%
na.omit() %>%
mutate(Time = "Mandante") %>%
rename(Placar = Placar_1)
visitante = resultados %>%
count(Placar_2) %>%
na.omit() %>%
mutate(Time = "Visitante") %>%
rename(Placar = Placar_2)
tmp = rbind(mandante, visitante) %>%
mutate(p = n/(nrow(resultados) - 1))
tmp %>%
ggplot(aes(fill = Time, y = p, x = Placar)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
xlab("Gols") +
ylab("%") +
scale_x_continuous(breaks = 0:6)
tmp = resultados %>%
mutate(resultado = ifelse(Placar_1 == Placar_2, "Empate", ifelse(Placar_1 > Placar_2, "Vitória do mandante", "Vitória do visitante"))) %>%
count(resultado) %>%
arrange(desc(n)) %>%
mutate(p = n/(nrow(resultados)))
tmp
tmp %>%
mutate() %>%
na.omit() %>%
mutate(resultado = factor(resultado, levels = c("Vitória do mandante", "Empate", "Vitória do visitante"))) %>%
ggplot(aes(x = resultado, y = p)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
xlab("") +
ylab("%")
reds$Acréscimo[which(is.na(reds$Acréscimo))] = 0
reds = reds %>%
mutate(Minuto = Minuto + Acréscimo)
reds$Minuto[which(reds$Minuto > 50)] = 50
tib_zeros = tibble(Minuto = c(1:50, 1:50), Tempo = c(rep("1º", 50), rep("2º", 50)), n = 0L)
complete_zeros <- function(tib_count) {
tib_count %>%
full_join(tib_zeros, by = c("Minuto", "Tempo", "n")) %>%
group_by(Minuto, Tempo) %>%
summarise(n = sum(n))
}
reds %>%
count(Minuto, Tempo) %>%
complete_zeros() %>%
mutate(p = n/nrow(reds)) %>%
ggplot(aes(x = Minuto, y = p, col = Tempo)) +
geom_line(size = 1) +
geom_point(size = 2) +
theme_bw() +
ylab("Cartões vermelhos (%)") +
scale_x_continuous(breaks = seq(from = 0, to = 50, by = 5),
labels = c(seq(from = 0, to = 45, by = 5), "50+"))
resultados$Acréscimos_1[which(resultados$Acréscimos_1 > 10)] = 10
resultados %>%
count(Acréscimos_1) %>%
mutate(p = n/nrow(resultados)) %>%
ggplot(aes(x = Acréscimos_1, y = p)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
xlab("") +
ylab("Acréscimos do primeiro tempo (%)") +
scale_x_continuous(breaks = 0:10,
labels = c(0:9, "10+"))
resultados$Acréscimos_2[which(resultados$Acréscimos_2 > 10)] = 10
resultados %>%
count(Acréscimos_2) %>%
mutate(p = n/nrow(resultados)) %>%
ggplot(aes(x = Acréscimos_2, y = p)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
xlab("") +
ylab("Acréscimos do primeiro tempo (%)") +
scale_x_continuous(breaks = 0:10,
labels = c(0:9, "10+"))
load("data/resultados.RData")
medias = resultados %>%
filter(Ano >= 2014, Campeonato == "Campeonato Brasileiro Série A") %>%
group_by(Ano) %>%
summarise(Acréscimos_1 = mean(Acréscimos_1),
Acréscimos_2 = mean(Acréscimos_2))
tibble(Tempo = c(rep("1º", nrow(medias)), rep("2º", nrow(medias))),
Ano = rep(medias$Ano, 2),
Média = c(medias$Acréscimos_1, medias$Acréscimos_2)) %>%
ggplot(aes(x = Ano, y = Média, col = Tempo)) +
geom_line(size = 1) +
geom_point(size = 2) +
theme_bw() +
ylab("Média de acréscimos") +
ylim(0, 5)
