
library(CVXR)

load("serie_a_2019.RData")

log_lik <- function(alpha, beta, gamma) {
  lambda = alpha[i] + beta[j] + gamma
  mu = alpha[j] + beta[i]
  sum(-exp(lambda) + x*lambda - exp(mu) + y*mu)
}

alpha = Variable(20)
beta = Variable(20)
gamma = Variable(1)

objective = Maximize(log_lik(alpha, beta, gamma))
problem = Problem(objective)
set.seed(1)

solution0 = solve(problem)

solution0$getValue(gamma)

solution = solve(problem)
mod_0_CVXR = c(solution$getValue(alpha), solution$getValue(beta), solution$getValue(gamma))
save(mod_0_CVXR, file = "sol/mod_0_CVXR.RData")
mod_0_CVXR_lik = solution$value
save(mod_0_CVXR_lik, file = "sol/mod_0_CVXR_lik.RData")
