"0","reds$Stoppage_Time[which(is.na(reds$Stoppage_Time))] = 0"
"0",""
"0","reds = reds %>%"
"0","  mutate(Minute = Minute + Stoppage_Time)"
"0",""
"0","reds$Minute[which(reds$Minute > 50)] = 50"
"0",""
"0","tib_zeros = tibble(Team = c(rep(1, 100), rep(2, 100)),"
"0","                   Half = c(rep(1, 50), rep(2, 50), rep(1, 50), rep(2, 50)),"
"0","                   Minute = c(1:50, 1:50, 1:50, 1:50),"
"0","                   n = 0L)"
"0","complete_zeros <- function(tib_count) {"
"0","  tib_count %>%"
"0","    full_join(tib_zeros, by = c(""Team"", ""Half"", ""Minute"", ""n"")) %>%"
"0","    group_by(Minute, Half) %>%"
"0","    summarise(n = sum(n))"
"0","}"
"0",""
"0","tmp = reds %>%"
"0","  count(Team, Half, Minute) %>%"
"0","  complete_zeros() %>%"
"0","  mutate(rate = n/N)"
