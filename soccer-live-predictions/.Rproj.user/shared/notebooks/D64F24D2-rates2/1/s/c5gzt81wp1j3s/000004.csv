"0","            #  1     2     3       4     "
"0","intervals = c(0, 0.015, 0.03, 0.045, Inf)"
"0",""
"0","interval_x = list(); interval_y = list()"
"0","for(k in 1:N) {"
"0","  tmp_interval_x = rep(NA, length(intensity_x[[k]]))"
"0","  tmp_interval_y = rep(NA, length(intensity_y[[k]]))"
"0","  for(i in 1:(length(intervals)-1)) {"
"0","    tmp_interval_x[which(intensity_x[[k]] >= "
"0","                           intervals[i] & intensity_x[[k]] < intervals[i+1])] = i"
"0","    tmp_interval_y[which(intensity_y[[k]] >= "
"0","                           intervals[i] & intensity_y[[k]] < intervals[i+1])] = i"
"0","  }"
"0","  interval_x[[k]] = tmp_interval_x"
"0","  interval_y[[k]] = tmp_interval_y"
"0","}"
"0",""
"0","interval_x %>%"
"0","  unlist() %>%"
"0","  table()"
"1",".
"
"1","     1 "
"1","     2 "
"1","     3 "
"1","     4 "
"1","
"
"1","152997 "
"1"," 41171 "
"1"," 19075 "
"1"," 11067 "
"1","
"
"0","interval_y %>%"
"0","  unlist() %>%"
"0","  table()"
"1",".
"
"1","     1 "
"1","     2 "
"1","     3 "
"1","     4 "
"1","
"
"1","177786 "
"1"," 30111 "
"1"," 10307 "
"1","  6106 "
"1","
"
"0","xy = list()"
"0","for(k in 1:N) {"
"0","  xy[[k]] = paste(interval_x[[k]], interval_y[[k]], sep = ""-"")"
"0","}"
"0",""
"0","tables = lapply(xy, table)"
"0",""
"0","scores = NULL"
"0","c = 0"
"0","for(i in 1:4) {"
"0","  for(j in 1:4) {"
"0","    c = c + 1"
"0","    scores[c] = paste(i, j, sep = ""-"")"
"0","  }"
"0","}"
"0",""
"0","diff_x = list(); diff_y = list()"
"0","for(k in 1:N) {"
"0","  diff_x[[k]] = c(diff(x[[k]]))"
"0","  diff_y[[k]] = c(diff(y[[k]]))"
"0","}"
"0",""
"0","t_x = list(); t_y = list()"
"0","for(k in 1:N) {"
"0","  t_x[[k]] = which(diff_x[[k]] == 1)"
"0","  t_y[[k]] = which(diff_y[[k]] == 1)"
"0","}"
"0",""
"0","delta_home = list(); delta_away = list(); t = list()"
"0","for(i in 1:length(scores)) {"
"0","  tmp_delta_home = NULL; tmp_delta_away = NULL; tmp_t = NULL"
"0","  for(k in 1:N) {"
"0","    if(scores[i] %in% names(tables[[k]])) {"
"0","      tmp_t[k] = tables[[k]][scores[i]]"
"0","      minutes = which(xy[[k]] == scores[i])"
"0","      tmp_delta_home[k] = sum(t_x[[k]] %in% minutes)"
"0","      tmp_delta_away[k] = sum(t_y[[k]] %in% minutes)"
"0","    } else {"
"0","      tmp_delta_home[k] = 0"
"0","      tmp_delta_away[k] = 0"
"0","      tmp_t[k] = 0"
"0","    }"
"0","  }"
"0","  delta_home[[i]] = tmp_delta_home"
"0","  delta_away[[i]] = tmp_delta_away"
"0","  t[[i]] = tmp_t"
"0","}"
"0",""
"0","rates = NULL; rates_home = NULL; rates_away = NULL"
"0","for(i in 1:length(scores)) {"
"0","  rates[i] = (sum(delta_home[[i]]) + sum(delta_away[[i]])) / sum(t[[i]])"
"0","  rates_home[i] = sum(delta_home[[i]]) / sum(t[[i]])"
"0","  rates_away[i] = sum(delta_away[[i]]) / sum(t[[i]])"
"0","}"
"0",""
"0","sd_home = NULL; sd_away = NULL; sd = NULL"
"0","for(i in 1:length(scores)) {"
"0","  sd[i] = rates[i] / sqrt(sum(delta_home[[i]]) + sum(delta_away[[i]]))"
"0","  sd_home[i] = rates_home[i] / sqrt(sum(delta_home[[i]]))"
"0","  sd_away[i] = rates_away[i] / sqrt(sum(delta_away[[i]]))"
"0","} "
"0",""
"0","tib = tibble(Rate = paste0(""$\\nu_{"", stringr::str_replace(scores, ""-"", """"), ""}$""), "
"0","             `Est.(both)` = rates, `Est.(home)` = rates_home, `Est.(away)` = rates_away,"
"0","             `S.e.(both)` = sd, `S.e.(home)` = sd_home, `S.e.(away)` = sd_away)"
