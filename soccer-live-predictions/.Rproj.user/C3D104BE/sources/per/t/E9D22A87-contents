---
title: "Goodness of fit"
output: pdf_document
---

```{r, message = FALSE, warning = FALSE}
library(knitr)
library(dplyr)
library(ggplot2)

load("data/goodness_of_fit_dc.RData")
```

```{r}
for(i in 2:19) {
  tab_results[i,] = tab_results[i,] - tab_results[1,]
}
kable(tab_results, digits = 4)
```

```{r}
for(i in 2:19) {
  tab_home_goals[i,] = tab_home_goals[i,] - tab_home_goals[1,]
}
kable(tab_home_goals, digits = 4)
```

```{r}
for(i in 2:19) {
  tab_away_goals[i,] = tab_away_goals[i,] - tab_away_goals[1,]
}
kable(tab_away_goals, digits = 4)
```

\clearpage 

```{r}
tibble(x = sims$pred_0$loglik_results_mod_0) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_0_pred_0, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 0 at minute 0")
```

```{r}
sum(sims$pred_0$loglik_results_mod_0 <= loglik_observed_results_mod_0_pred_0) /
  length(sims$pred_0$loglik_results_mod_0)
```

\clearpage

```{r}
tibble(x = sims$pred_15$loglik_results_mod_0) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_0_pred_15, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 0 at minute 15")
```

```{r}
sum(sims$pred_15$loglik_results_mod_0 <= loglik_observed_results_mod_0_pred_15) /
  length(sims$pred_15$loglik_results_mod_0)
```

\clearpage

```{r}
tibble(x = sims$pred_30$loglik_results_mod_0) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_0_pred_30, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 0 at minute 30")
```

```{r}
sum(sims$pred_30$loglik_results_mod_0 <= loglik_observed_results_mod_0_pred_30) /
  length(sims$pred_30$loglik_results_mod_0)
```

\clearpage

```{r}
tibble(x = sims$pred_45$loglik_results_mod_0) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_0_pred_45, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 0 at minute 45")
```

```{r}
sum(sims$pred_45$loglik_results_mod_0 <= loglik_observed_results_mod_0_pred_45) /
  length(sims$pred_45$loglik_results_mod_0)
```

\clearpage

```{r}
tibble(x = sims$pred_60$loglik_results_mod_0) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_0_pred_60, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 0 at minute 60")
```

```{r}
sum(sims$pred_60$loglik_results_mod_0 <= loglik_observed_results_mod_0_pred_60) /
  length(sims$pred_60$loglik_results_mod_0)
```

\clearpage

```{r}
tibble(x = sims$pred_75$loglik_results_mod_0) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_0_pred_75, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 0 at minute 75")
```

```{r}
sum(sims$pred_75$loglik_results_mod_0 <= loglik_observed_results_mod_0_pred_75) /
  length(sims$pred_75$loglik_results_mod_0)
```

\clearpage

```{r}
tibble(x = sims$pred_0$loglik_results_mod_3) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_3_pred_0, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 3 at minute 0")
```

```{r}
sum(sims$pred_0$loglik_results_mod_3 <= loglik_observed_results_mod_3_pred_0) /
  length(sims$pred_0$loglik_results_mod_3)
```

\clearpage

```{r}
tibble(x = sims$pred_15$loglik_results_mod_3) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_3_pred_15, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 3 at minute 15")
```

```{r}
sum(sims$pred_15$loglik_results_mod_3 <= loglik_observed_results_mod_3_pred_15) /
  length(sims$pred_15$loglik_results_mod_3)
```

\clearpage

```{r}
tibble(x = sims$pred_30$loglik_results_mod_3) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_3_pred_30, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 3 at minute 30")
```

```{r}
sum(sims$pred_30$loglik_results_mod_3 <= loglik_observed_results_mod_3_pred_30) /
  length(sims$pred_30$loglik_results_mod_3)
```

\clearpage

```{r}
tibble(x = sims$pred_45$loglik_results_mod_3) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_3_pred_45, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 3 at minute 45")
```

```{r}
sum(sims$pred_45$loglik_results_mod_3 <= loglik_observed_results_mod_3_pred_45) /
  length(sims$pred_45$loglik_results_mod_3)
```

\clearpage

```{r}
tibble(x = sims$pred_60$loglik_results_mod_3) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_3_pred_60, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 3 at minute 60")
```

```{r}
sum(sims$pred_60$loglik_results_mod_3 <= loglik_observed_results_mod_3_pred_60) /
  length(sims$pred_60$loglik_results_mod_3)
```

\clearpage

```{r}
tibble(x = sims$pred_75$loglik_results_mod_3) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_3_pred_75, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 3 at minute 75")
```

```{r}
sum(sims$pred_75$loglik_results_mod_3 <= loglik_observed_results_mod_3_pred_75) /
  length(sims$pred_75$loglik_results_mod_3)
```

\clearpage

```{r}
tibble(x = sims$pred_0$loglik_results_mod_8) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_8_pred_0, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 8 at minute 0")
```

```{r}
sum(sims$pred_0$loglik_results_mod_8 <= loglik_observed_results_mod_8_pred_0) /
  length(sims$pred_0$loglik_results_mod_8)
```

\clearpage

```{r}
tibble(x = sims$pred_15$loglik_results_mod_8) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_8_pred_15, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 8 at minute 15")
```

```{r}
sum(sims$pred_15$loglik_results_mod_8 <= loglik_observed_results_mod_8_pred_15) /
  length(sims$pred_15$loglik_results_mod_8)
```

\clearpage

```{r}
tibble(x = sims$pred_30$loglik_results_mod_8) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_8_pred_30, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 8 at minute 30")
```

```{r}
sum(sims$pred_30$loglik_results_mod_8 <= loglik_observed_results_mod_8_pred_30) /
  length(sims$pred_30$loglik_results_mod_8)
```

\clearpage

```{r}
tibble(x = sims$pred_45$loglik_results_mod_8) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_8_pred_45, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 8 at minute 45")
```

```{r}
sum(sims$pred_45$loglik_results_mod_8 <= loglik_observed_results_mod_8_pred_45) /
  length(sims$pred_45$loglik_results_mod_8)
```

\clearpage

```{r}
tibble(x = sims$pred_60$loglik_results_mod_8) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_8_pred_60, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 8 at minute 60")
```

```{r}
sum(sims$pred_60$loglik_results_mod_8 <= loglik_observed_results_mod_8_pred_60) /
  length(sims$pred_60$loglik_results_mod_8)
```

\clearpage

```{r}
tibble(x = sims$pred_75$loglik_results_mod_8) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_8_pred_75, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Results model 8 at minute 75")
```

```{r}
sum(sims$pred_75$loglik_results_mod_8 <= loglik_observed_results_mod_8_pred_75) /
  length(sims$pred_75$loglik_results_mod_8)
```

\clearpage 

```{r}
tibble(x = sims$pred_0$loglik_scores_mod_0) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_0_pred_0, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 0 at minute 0")
```

```{r}
sum(sims$pred_0$loglik_scores_mod_0 >= loglik_observed_scores_mod_0_pred_0) /
  length(sims$pred_0$loglik_scores_mod_0)
```

\clearpage

```{r}
tibble(x = sims$pred_15$loglik_scores_mod_0) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_0_pred_15, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 0 at minute 15")
```

```{r}
sum(sims$pred_15$loglik_scores_mod_0 <= loglik_observed_scores_mod_0_pred_15) /
  length(sims$pred_15$loglik_scores_mod_0)
```

\clearpage

```{r}
tibble(x = sims$pred_30$loglik_scores_mod_0) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_0_pred_30, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 0 at minute 30")
```

```{r}
sum(sims$pred_30$loglik_scores_mod_0 <= loglik_observed_scores_mod_0_pred_30) /
  length(sims$pred_30$loglik_scores_mod_0)
```

\clearpage

```{r}
tibble(x = sims$pred_45$loglik_scores_mod_0) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_0_pred_45, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 0 at minute 45")
```

```{r}
sum(sims$pred_45$loglik_scores_mod_0 <= loglik_observed_scores_mod_0_pred_45) /
  length(sims$pred_45$loglik_scores_mod_0)
```

\clearpage

```{r}
tibble(x = sims$pred_60$loglik_scores_mod_0) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_0_pred_60, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 0 at minute 60")
```

```{r}
sum(sims$pred_60$loglik_scores_mod_0 <= loglik_observed_scores_mod_0_pred_60) /
  length(sims$pred_60$loglik_scores_mod_0)
```

\clearpage

```{r}
tibble(x = sims$pred_75$loglik_scores_mod_0) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_0_pred_75, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 0 at minute 75")
```

```{r}
sum(sims$pred_75$loglik_scores_mod_0 <= loglik_observed_scores_mod_0_pred_75) /
  length(sims$pred_75$loglik_scores_mod_0)
```

\clearpage

```{r}
tibble(x = sims$pred_0$loglik_scores_mod_3) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_3_pred_0, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 3 at minute 0")
```

```{r}
sum(sims$pred_0$loglik_scores_mod_3 <= loglik_observed_scores_mod_3_pred_0) /
  length(sims$pred_0$loglik_scores_mod_3)
```

\clearpage

```{r}
tibble(x = sims$pred_15$loglik_scores_mod_3) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_3_pred_15, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 3 at minute 15")
```

```{r}
sum(sims$pred_15$loglik_scores_mod_3 <= loglik_observed_scores_mod_3_pred_15) /
  length(sims$pred_15$loglik_scores_mod_3)
```

\clearpage

```{r}
tibble(x = sims$pred_30$loglik_scores_mod_3) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_3_pred_30, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 3 at minute 30")
```

```{r}
sum(sims$pred_30$loglik_scores_mod_3 <= loglik_observed_scores_mod_3_pred_30) /
  length(sims$pred_30$loglik_scores_mod_3)
```

\clearpage

```{r}
tibble(x = sims$pred_45$loglik_scores_mod_3) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_3_pred_45, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 3 at minute 45")
```

```{r}
sum(sims$pred_45$loglik_scores_mod_3 <= loglik_observed_scores_mod_3_pred_45) /
  length(sims$pred_45$loglik_scores_mod_3)
```

\clearpage

```{r}
tibble(x = sims$pred_60$loglik_scores_mod_3) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_3_pred_60, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 3 at minute 60")
```

```{r}
sum(sims$pred_60$loglik_scores_mod_3 <= loglik_observed_scores_mod_3_pred_60) /
  length(sims$pred_60$loglik_scores_mod_3)
```

\clearpage

```{r}
tibble(x = sims$pred_75$loglik_scores_mod_3) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_3_pred_75, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 3 at minute 75")
```

```{r}
sum(sims$pred_75$loglik_scores_mod_3 <= loglik_observed_scores_mod_3_pred_75) /
  length(sims$pred_75$loglik_scores_mod_3)
```

\clearpage

```{r}
tibble(x = sims$pred_0$loglik_scores_mod_8) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_8_pred_0, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 8 at minute 0")
```

```{r}
sum(sims$pred_0$loglik_scores_mod_8 <= loglik_observed_scores_mod_8_pred_0) /
  length(sims$pred_0$loglik_scores_mod_8)
```

\clearpage

```{r}
tibble(x = sims$pred_15$loglik_scores_mod_8) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_8_pred_15, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 8 at minute 15")
```

```{r}
sum(sims$pred_15$loglik_scores_mod_8 <= loglik_observed_scores_mod_8_pred_15) /
  length(sims$pred_15$loglik_scores_mod_8)
```

\clearpage

```{r}
tibble(x = sims$pred_30$loglik_scores_mod_8) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_8_pred_30, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 8 at minute 30")
```

```{r}
sum(sims$pred_30$loglik_scores_mod_8 <= loglik_observed_scores_mod_8_pred_30) /
  length(sims$pred_30$loglik_scores_mod_8)
```

\clearpage

```{r}
tibble(x = sims$pred_45$loglik_scores_mod_8) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_8_pred_45, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 8 at minute 45")
```

```{r}
sum(sims$pred_45$loglik_scores_mod_8 <= loglik_observed_scores_mod_8_pred_45) /
  length(sims$pred_45$loglik_scores_mod_8)
```

\clearpage

```{r}
tibble(x = sims$pred_60$loglik_scores_mod_8) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_8_pred_60, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 8 at minute 60")
```

```{r}
sum(sims$pred_60$loglik_scores_mod_8 <= loglik_observed_scores_mod_8_pred_60) /
  length(sims$pred_60$loglik_scores_mod_8)
```

\clearpage

```{r}
tibble(x = sims$pred_75$loglik_scores_mod_8) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_8_pred_75, col = "red") +
  xlab("Log joint PDF") +
  ylab("Count") +
  ggtitle("Scores model 8 at minute 75")
```

```{r}
sum(sims$pred_75$loglik_scores_mod_8 <= loglik_observed_scores_mod_8_pred_75) /
  length(sims$pred_75$loglik_scores_mod_8)
```