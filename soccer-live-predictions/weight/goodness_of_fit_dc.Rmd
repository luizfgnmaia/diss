---
title: "Goodness of fit"
output: pdf_document
---

```{r, message = FALSE, warning = FALSE}
library(knitr)
library(dplyr)
library(ggplot2)

load("data/goodness_of_fit_dc.RData")
```

```{r}
kable(tab_results, digits = 4)
```

```{r}
kable(tab_home_goals, digits = 4)
```

```{r}
kable(tab_away_goals, digits = 4)
```

```{r}
tibble(x = sims[["loglik_results_mod_0"]]) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_0, col = "red") +
  xlab("Log-likelihood") +
  ylab("Count") +
  ggtitle("Results model 0")
```

```{r}
sum(sims[["loglik_results_mod_0"]] <= loglik_observed_results_mod_0) /
  length(sims[["loglik_results_mod_0"]])
```

```{r}
tibble(x = sims[["loglik_scores_mod_0"]]) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_0, col = "red") +
  xlab("Log-likelihood") +
  ylab("Count") +
  ggtitle("Scores model 0")
```

```{r}
sum(sims[["loglik_scores_mod_0"]] >= loglik_observed_scores_mod_0) /
  length(sims[["loglik_scores_mod_0"]])
```

```{r}
tibble(x = sims[["loglik_results_mod_3"]]) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_3, col = "red") +
  xlab("Log-likelihood") +
  ylab("Count") +
  ggtitle("Results model 3")
```

```{r}
sum(sims[["loglik_results_mod_3"]] <= loglik_observed_results_mod_3) /
  length(sims[["loglik_results_mod_3"]])
```

```{r}
tibble(x = sims[["loglik_scores_mod_3"]]) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_3, col = "red") +
  xlab("Log-likelihood") +
  ylab("Count") +
  ggtitle("Scores model 3")
```

```{r}
sum(sims[["loglik_scores_mod_3"]] <= loglik_observed_scores_mod_3) /
  length(sims[["loglik_scores_mod_3"]])
```

```{r}
tibble(x = sims[["loglik_results_mod_8"]]) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_results_mod_8, col = "red") +
  xlab("Log-likelihood") +
  ylab("Count") +
  ggtitle("Results model 8")
```

```{r}
sum(sims[["loglik_results_mod_8"]] <= loglik_observed_results_mod_8) /
  length(sims[["loglik_results_mod_8"]])
```

```{r}
tibble(x = sims[["loglik_scores_mod_8"]]) %>%
  ggplot(aes(x = x)) +
  geom_histogram(bins = 50) +
  theme_bw() +
  geom_vline(xintercept = loglik_observed_scores_mod_8, col = "red") +
  xlab("Log-likelihood") +
  ylab("Count") +
  ggtitle("Scores model 8")
```

```{r}
sum(sims[["loglik_scores_mod_8"]] <= loglik_observed_scores_mod_8) /
  length(sims[["loglik_scores_mod_8"]])
```