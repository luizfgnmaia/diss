results = mod$results
score = mod$score
results
score
length(mod)
mod[[i]]$Results
i=1
mod[[i]]$Results
mod
mod[[1]]
mod[[i]]$Result
mod[[i]]
mod[[i]]$pred_0$Result
mod[[i]]$pred_0$Score
score = mod[[i]]$pred_0$Score
score
length(score)
library(stringr)
names(score)
home = str_extract(names(score), ".*(?=)")
home
home
str_extract(names(score), ".*(?=)")
home = str_extract(names(score), ".*(?=-)")
home
away = str_extract(names(score), "(?<=-).*")
away
score = mod[[i]]$pred_0$Score
home = str_extract(names(score), ".*(?=-)")
away = str_extract(names(score), "(?<=-).*")
tib_score = tibble()
for(j in length(score)) {
tmp = tibble(Home = home[j], Away = away[j], p = score[j])
tib_score = rbind(tib, tmp)
}
tib_score = tibble()
for(j in length(score)) {
tmp = tibble(Home = home[j], Away = away[j], p = score[j])
tib_score = rbind(tib_score, tmp)
}
tib_score
j
tib_score = tibble()
for(j in 1:length(score)) {
tmp = tibble(Home = home[j], Away = away[j], p = score[j])
tib_score = rbind(tib_score, tmp)
}
tib_score
tib_score %>%
filter(Home == 1)
tib_score %>%
filter(Home == 1) %>%
tib_score %>%
filter(Home == 1) %>%
.$p %>%
sum()
tib_score %>%
filter(Home == 1) %>%
.$p %>%
sum()
tib_score %>%
filter(Home == 1) %>%
.$p %>%
sum()
for(g in 0:4) {
home_goals[i] = tib_score %>%
filter(Home == i) %>%
.$p %>%
sum()
}
home_goals = NULL
away_goals = NULL
for(g in 0:4) {
home_goals[i] = tib_score %>%
filter(Home == i) %>%
.$p %>%
sum()
}
home_goals
for(g in 0:4) {
home_goals[g+1] = tib_score %>%
filter(Home == g) %>%
.$p %>%
sum()
}
home_goals
sum(home_goals)
library(dplyr)
library(stringr)
load("pred 2020/data/predictions_mod_0.RData")
load("pred 2020/data/predictions_mod_3.RData")
load("pred 2020/data/predictions_mod_3_2019.RData")
load("pred 2020/data/predictions_mod_3_2015_2019.RData")
load("pred 2020/data/predictions_mod_3_2015_2019_g.RData")
load("pred 2020/data/predictions_mod_5_2015_2019.RData")
f <- function(mod) {
H = NULL
D = NULL
A = NULL
for(i in 1:length(mod)) {
H[i] = mod[[i]]$pred_0$Result[1]
D[i] = mod[[i]]$pred_0$Result[2]
A[i] = mod[[i]]$pred_0$Result[3]
result = c(H, D, A)
names(result) = c("Home", "Draw", "Away")
score = mod[[i]]$pred_0$Score
home = str_extract(names(score), ".*(?=-)")
away = str_extract(names(score), "(?<=-).*")
tib_score = tibble()
for(j in 1:length(score)) {
tmp = tibble(Home = home[j], Away = away[j], p = score[j])
tib_score = rbind(tib_score, tmp)
}
home_goals = NULL
away_goals = NULL
for(g in 0:4) {
home_goals[g+1] = tib_score %>%
filter(Home == g) %>%
.$p %>%
sum()
away_goals[g+1] = tib_score %>%
filter(Away == g) %>%
.$p %>%
sum()
}
Home_Goals[6] = 1 - sum(Home_Goals)
Away_Goals[6] = 1 - sum(Away_Goals)
}
name(Home_Goals) = c(0:4, "5+")
name(Away_Goals) = c(0:4, "5+")
list(Result, Home_Goals, Away_Goals)
}
library(dplyr)
library(stringr)
load("pred 2020/data/predictions_mod_0.RData")
load("pred 2020/data/predictions_mod_3.RData")
load("pred 2020/data/predictions_mod_3_2019.RData")
load("pred 2020/data/predictions_mod_3_2015_2019.RData")
load("pred 2020/data/predictions_mod_3_2015_2019_g.RData")
load("pred 2020/data/predictions_mod_5_2015_2019.RData")
f <- function(predictions) {
H = NULL
D = NULL
A = NULL
for(i in 1:length(predictions)) {
H[i] = predictions[[i]]$pred_0$Result[1]
D[i] = predictions[[i]]$pred_0$Result[2]
A[i] = predictions[[i]]$pred_0$Result[3]
result = c(H, D, A)
names(result) = c("Home", "Draw", "Away")
score = predictions[[i]]$pred_0$Score
home = str_extract(names(score), ".*(?=-)")
away = str_extract(names(score), "(?<=-).*")
tib_score = tibble()
for(j in 1:length(score)) {
tmp = tibble(Home = home[j], Away = away[j], p = score[j])
tib_score = rbind(tib_score, tmp)
}
home_goals = NULL
away_goals = NULL
for(g in 0:4) {
home_goals[g+1] = tib_score %>%
filter(Home == g) %>%
.$p %>%
sum()
away_goals[g+1] = tib_score %>%
filter(Away == g) %>%
.$p %>%
sum()
}
Home_Goals[6] = 1 - sum(Home_Goals)
Away_Goals[6] = 1 - sum(Away_Goals)
}
name(Home_Goals) = c(0:4, "5+")
name(Away_Goals) = c(0:4, "5+")
list(Result, Home_Goals, Away_Goals)
}
f()
f(predictions_mod_0)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/pred 2020/goodness_of_fit.R', echo=TRUE)
library(dplyr)
library(stringr)
load("pred 2020/data/predictions_mod_0.RData")
load("pred 2020/data/predictions_mod_3.RData")
load("pred 2020/data/predictions_mod_3_2019.RData")
load("pred 2020/data/predictions_mod_3_2015_2019.RData")
load("pred 2020/data/predictions_mod_3_2015_2019_g.RData")
load("pred 2020/data/predictions_mod_5_2015_2019.RData")
f <- function(predictions) {
H = NULL
D = NULL
A = NULL
for(i in 1:length(predictions)) {
H[i] = predictions[[i]]$pred_0$Result[1]
D[i] = predictions[[i]]$pred_0$Result[2]
A[i] = predictions[[i]]$pred_0$Result[3]
result = c(H, D, A)
names(result) = c("Home", "Draw", "Away")
score = predictions[[i]]$pred_0$Score
home = str_extract(names(score), ".*(?=-)")
away = str_extract(names(score), "(?<=-).*")
tib_score = tibble()
for(j in 1:length(score)) {
tmp = tibble(Home = home[j], Away = away[j], p = score[j])
tib_score = rbind(tib_score, tmp)
}
Home_Goals = NULL
Away_Goals = NULL
for(g in 0:4) {
Home_Goals[g+1] = tib_score %>%
filter(Home == g) %>%
.$p %>%
sum()
Away_Goals[g+1] = tib_score %>%
filter(Away == g) %>%
.$p %>%
sum()
}
Home_Goals[6] = 1 - sum(Home_Goals)
Away_Goals[6] = 1 - sum(Away_Goals)
}
names(Home_Goals) = c(0:4, "5+")
names(Away_Goals) = c(0:4, "5+")
list(Result, Home_Goals, Away_Goals)
}
f(predictions_mod_0)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/pred 2020/goodness_of_fit.R', echo=TRUE)
library(dplyr)
library(stringr)
load("pred 2020/data/predictions_mod_0.RData")
load("pred 2020/data/predictions_mod_3.RData")
load("pred 2020/data/predictions_mod_3_2019.RData")
load("pred 2020/data/predictions_mod_3_2015_2019.RData")
load("pred 2020/data/predictions_mod_3_2015_2019_g.RData")
load("pred 2020/data/predictions_mod_5_2015_2019.RData")
f <- function(predictions) {
H = NULL
D = NULL
A = NULL
lst_home = list()
lst_away = list()
for(i in 1:length(predictions)) {
H[i] = predictions[[i]]$pred_0$Result[1]
D[i] = predictions[[i]]$pred_0$Result[2]
A[i] = predictions[[i]]$pred_0$Result[3]
score = predictions[[i]]$pred_0$Score
home = str_extract(names(score), ".*(?=-)")
away = str_extract(names(score), "(?<=-).*")
tib_score = tibble()
for(j in 1:length(score)) {
tmp = tibble(Home = home[j], Away = away[j], p = score[j])
tib_score = rbind(tib_score, tmp)
}
home_goals = NULL
away_goals = NULL
for(g in 0:4) {
home_goals[g+1] = tib_score %>%
filter(Home == g) %>%
.$p %>%
sum()
away_goals[g+1] = tib_score %>%
filter(Away == g) %>%
.$p %>%
sum()
}
home_goals[6] = 1 - sum(home_goals)
away_goals[6] = 1 - sum(away_goals)
}
lst_home[[i]] = home_goals
lst_away[[i]] = away_goals
}
f(predictions_mod_0)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/pred 2020/goodness_of_fit.R', echo=TRUE)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/pred 2020/goodness_of_fit.R', echo=TRUE)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/pred 2020/goodness_of_fit.R', echo=TRUE)
sum(a[[1]])
sum(a[[2]])
sum(a[[3]])
library(dplyr)
library(stringr)
load("pred 2020/data/predictions_mod_0.RData")
load("pred 2020/data/predictions_mod_3.RData")
load("pred 2020/data/predictions_mod_3_2019.RData")
load("pred 2020/data/predictions_mod_3_2015_2019.RData")
load("pred 2020/data/predictions_mod_3_2015_2019_g.RData")
load("pred 2020/data/predictions_mod_5_2015_2019.RData")
f <- function(predictions) {
H = NULL
D = NULL
A = NULL
lst_home = list()
lst_away = list()
for(i in 1:length(predictions)) {
H[i] = predictions[[i]]$pred_0$Result[1]
D[i] = predictions[[i]]$pred_0$Result[2]
A[i] = predictions[[i]]$pred_0$Result[3]
score = predictions[[i]]$pred_0$Score
home = str_extract(names(score), ".*(?=-)")
away = str_extract(names(score), "(?<=-).*")
tib_score = tibble()
for(j in 1:length(score)) {
tmp = tibble(Home = home[j], Away = away[j], p = score[j])
tib_score = rbind(tib_score, tmp)
}
home_goals = NULL
away_goals = NULL
for(g in 0:4) {
home_goals[g+1] = tib_score %>%
filter(Home == g) %>%
.$p %>%
sum()
away_goals[g+1] = tib_score %>%
filter(Away == g) %>%
.$p %>%
sum()
}
home_goals[6] = 1 - sum(home_goals)
away_goals[6] = 1 - sum(away_goals)
}
lst_home[[i]] = home_goals
lst_away[[i]] = away_goals
Results = c(mean(H), mean(D), mean(A))
names(Results) = c("Home", "Away", "Draww")
mat_home = do.call(rbind, lst_home)
mat_away = do.call(rbind, lst_away)
Home_Goals = apply(mat_home, 2, mean)
Away_Goals = apply(mat_away, 2, mean)
names(Home_Goals) = c(0:4, "5+")
names(Away_Goals) = c(0:4, "5+")
list(Results = Results, Home_Goals = Home_Goals, Away_Goals = Away_Goals)
}
a=f(predictions_mod_0)
a
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/pred 2020/goodness_of_fit.R', echo=TRUE)
save.image("pred 2020/data/goodness_of_fit.RData")
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/pred 2020/goodness_of_fit.R', echo=TRUE)
lst = list(prob_mod_0, prob_mod_3, prob_mod_3_2019, prob_mod_3_2015_2019, prob_mod_3_2015_2019_g, prob_mod_5_2015_2019)
tab_results = tibble()
tab_home_goals = tibble()
tab_away_goals = tibble()
prob_mod_0$Results
tab_results = matrix()
tab_home_goals = matrix()
tab_away_goals = matrix()
rbind(tab_results, lst[[1]]$Results)
rbind(tab_results, lst[[1]]$Results)
tab_results = matrix()
tab_home_goals = matrix()
tab_away_goals = matrix()
rbind(tab_results, lst[[1]]$Results)
lst[[1]]$Results
tab_results = matrix(NA, ncol = 3, nrow = 6)
tab_home_goals = matrix(NA, ncol = 6, nrow = 6)
tab_away_goals = matrix(NA, ncol = 6, nrow = 6)
i=1
tab_results[i,] = lst[[i]]$Results
tab_results
x = NULL
y = NULL
for(i in 1:length(predictions_mod_0)) {
x[i] = predictions_mod_0[[i]]$Match$Score_Home
y[i] = predictions_mod_0[[i]]$Match$Score_Away
}
x
y
x = NULL
y = NULL
Result = NULL
for(i in 1:length(predictions_mod_0)) {
x[i] = predictions_mod_0[[i]]$Match$Score_Home
y[i] = predictions_mod_0[[i]]$Match$Score_Away
Result[i] = ifelse(x[i] > y[i], "Home",
ifelse(x[i] == y[i], "Draw",
"Away"))
}
table(Result)
Result = table(Result) / sum(Result)
sum(Result)
Result = table(Result) / sum(table(Result))
Result
?table
x = NULL
y = NULL
tmp = NULL
for(i in 1:length(predictions_mod_0)) {
x[i] = predictions_mod_0[[i]]$Match$Score_Home
y[i] = predictions_mod_0[[i]]$Match$Score_Away
Result[i] = ifelse(x[i] > y[i], "Home",
ifelse(x[i] == y[i], "Draw",
"Away"))
}
tmp
x = NULL
y = NULL
tmp = NULL
for(i in 1:length(predictions_mod_0)) {
x[i] = predictions_mod_0[[i]]$Match$Score_Home
y[i] = predictions_mod_0[[i]]$Match$Score_Away
tmp[i] = ifelse(x[i] > y[i], "Home",
ifelse(x[i] == y[i], "Draw",
"Away"))
}
tmp
x = NULL
y = NULL
tmp = NULL
for(i in 1:length(predictions_mod_0)) {
x[i] = predictions_mod_0[[i]]$Match$Score_Home
y[i] = predictions_mod_0[[i]]$Match$Score_Away
tmp[i] = ifelse(x[i] > y[i], "Home",
ifelse(x[i] == y[i], "Draw",
"Away"))
}
Result = c(sum(tmp == "Home"), sum(tmp == "Draw"), sum(tmp == "Away")) / length(tmp)
names(Result) = c("Home", "Draw", "Away")
Result
x
y
Result = c(sum(tmp == "Home"), sum(tmp == "Draw"), sum(tmp == "Away")) / length(tmp)
Home_Goals = c(sum(x == 0), sum(x == 1), sum(x == 2), sum(x == 3), sum(x == 4), sum(x >= 5)) / length(x)
Away_Goals = c(sum(y == 0), sum(y == 1), sum(y == 2), sum(y == 3), sum(y == 4), sum(y >= 5)) / length(y)
prob_mod_0
tmp = list(Result = Result, Home_Goals = Home_Goals, Away_Goals = Away_Goals)
lst = list(tmp, prob_mod_0, prob_mod_3, prob_mod_3_2019, prob_mod_3_2015_2019, prob_mod_3_2015_2019_g, prob_mod_5_2015_2019)
tab_results = matrix(NA, ncol = 3, nrow = 7)
tab_home_goals = matrix(NA, ncol = 6, nrow = 7)
tab_away_goals = matrix(NA, ncol = 6, nrow = 7)
for(i in 1:length(lst)) {
tab_results[i,] = lst[[i]]$Results
tab_home_goals[i,] = lst[[i]]$Home_Goals
tab_away_goals[i,] = lst[[i]]$Away_Goals
}
i
tab_results[i,]
lst[[i]]$Results
x = NULL
y = NULL
tmp = NULL
for(i in 1:length(predictions_mod_0)) {
x[i] = predictions_mod_0[[i]]$Match$Score_Home
y[i] = predictions_mod_0[[i]]$Match$Score_Away
tmp[i] = ifelse(x[i] > y[i], "Home",
ifelse(x[i] == y[i], "Draw",
"Away"))
}
Results = c(sum(tmp == "Home"), sum(tmp == "Draw"), sum(tmp == "Away")) / length(tmp)
Home_Goals = c(sum(x == 0), sum(x == 1), sum(x == 2), sum(x == 3), sum(x == 4), sum(x >= 5)) / length(x)
Away_Goals = c(sum(y == 0), sum(y == 1), sum(y == 2), sum(y == 3), sum(y == 4), sum(y >= 5)) / length(y)
tmp = list(Results = Result, Home_Goals = Home_Goals, Away_Goals = Away_Goals)
lst = list(tmp, prob_mod_0, prob_mod_3, prob_mod_3_2019, prob_mod_3_2015_2019, prob_mod_3_2015_2019_g, prob_mod_5_2015_2019)
tab_results = matrix(NA, ncol = 3, nrow = 7)
tab_home_goals = matrix(NA, ncol = 6, nrow = 7)
tab_away_goals = matrix(NA, ncol = 6, nrow = 7)
for(i in 1:length(lst)) {
tab_results[i,] = lst[[i]]$Results
tab_home_goals[i,] = lst[[i]]$Home_Goals
tab_away_goals[i,] = lst[[i]]$Away_Goals
}
rownames(tab_results) = c("0", "3", "3 (2019)", "3 (2015-2019), 3 (2015-2019) free gamma", "5 (2015-2019)")
rownames(tab_home_goals) = c("0", "3", "3 (2019)", "3 (2015-2019), 3 (2015-2019) free gamma", "5 (2015-2019)")
rownames(tab_away_goals) = c("0", "3", "3 (2019)", "3 (2015-2019), 3 (2015-2019) free gamma", "5 (2015-2019)")
colnames(tab_results) = c("Home", "Draw", "Away")
colnames(tab_home_goals) = c(0:4, "5+")
colnames(tab_away_goals) = c(0:4, "5+")
x = NULL
y = NULL
tmp = NULL
for(i in 1:length(predictions_mod_0)) {
x[i] = predictions_mod_0[[i]]$Match$Score_Home
y[i] = predictions_mod_0[[i]]$Match$Score_Away
tmp[i] = ifelse(x[i] > y[i], "Home",
ifelse(x[i] == y[i], "Draw",
"Away"))
}
Results = c(sum(tmp == "Home"), sum(tmp == "Draw"), sum(tmp == "Away")) / length(tmp)
Home_Goals = c(sum(x == 0), sum(x == 1), sum(x == 2), sum(x == 3), sum(x == 4), sum(x >= 5)) / length(x)
Away_Goals = c(sum(y == 0), sum(y == 1), sum(y == 2), sum(y == 3), sum(y == 4), sum(y >= 5)) / length(y)
tmp = list(Results = Result, Home_Goals = Home_Goals, Away_Goals = Away_Goals)
tmp = list(Results = Results, Home_Goals = Home_Goals, Away_Goals = Away_Goals)
lst = list(tmp, prob_mod_0, prob_mod_3, prob_mod_3_2019, prob_mod_3_2015_2019, prob_mod_3_2015_2019_g, prob_mod_5_2015_2019)
tab_results = matrix(NA, ncol = 3, nrow = 7)
tab_home_goals = matrix(NA, ncol = 6, nrow = 7)
tab_away_goals = matrix(NA, ncol = 6, nrow = 7)
for(i in 1:length(lst)) {
tab_results[i,] = lst[[i]]$Results
tab_home_goals[i,] = lst[[i]]$Home_Goals
tab_away_goals[i,] = lst[[i]]$Away_Goals
}
rownames(tab_results) = c("0", "3", "3 (2019)", "3 (2015-2019), 3 (2015-2019) free gamma", "5 (2015-2019)")
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/pred 2020/goodness_of_fit.R', echo=TRUE)
tab_results
rownames(tab_results) = c("Observed", "0", "3", "3 (2019)", "3 (2015-2019)", "3 (2015-2019) free gamma", "5 (2015-2019)")
rownames(tab_home_goals) = c("Observed", "0", "3", "3 (2019)", "3 (2015-2019)", "3 (2015-2019) free gamma", "5 (2015-2019)")
rownames(tab_away_goals) = c("Observed", "0", "3", "3 (2019)", "3 (2015-2019)", "3 (2015-2019) free gamma", "5 (2015-2019)")
colnames(tab_results) = c("Home", "Draw", "Away")
colnames(tab_home_goals) = c(0:4, "5+")
colnames(tab_away_goals) = c(0:4, "5+")
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/pred 2020/goodness_of_fit.R', echo=TRUE)
tab_results
tab_home_goals
apply(tab_home_goals, 1, sum)
apply(tab_away_goals, 1, sum)
tab_away_goals
library(dplyr)
load("data/goodness_of_fit.RData")
kable(tab_results)
library(knitr)
kable(tab_results)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/pred 2020/goodness_of_fit.R', echo=TRUE)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/pred 2020/goodness_of_fit.R', echo=TRUE)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/pred 2020/goodness_of_fit.R', echo=TRUE)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/pred 2020/goodness_of_fit.R', echo=TRUE)
