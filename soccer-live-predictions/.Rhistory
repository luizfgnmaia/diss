winner = c(home_win, draw, away_win)
names(winner) = c(home_team, "Draw", away_team)
freq_scores = NULL
nam = NULL
for(i in 1:21) {
for(j in 1:21) {
freq_scores = c(freq_scores, mat_results[i,j])
nam = c(nam, paste0(rownames(mat_results)[i], "-", rownames(mat_results)[j]))
}
}
names(freq_scores) = nam
list("Result" = winner, "Score" = freq_scores)
}
beta_i = 0
alpha_i = 0
beta_j = 0
alpha_j = 0
gamma = log(1.55)
remaining = 90
score_away = 0
score_home = 3
gamma = log(1.5)
remaining = 90
score_away = 0
score_home = 3
load("~/GitHub/soccer-live-predictions/soccer-live-predictions/weight/data/mod_0_dc.RData")
load("~/GitHub/soccer-live-predictions/soccer-live-predictions/weight/data/mod_0_dc.RData")
pred_mod_0(home_team = "Flamengo", away_team = "Fluminense")
pred_mod_0(mod_0,dc, home_team = "Flamengo", away_team = "Fluminense")
pred_mod_0(mod_0_dc, home_team = "Flamengo", away_team = "Fluminense")
home_team = "Flamengo"
away_team = "Fluminense"
score_home = 0
score_away = 0
minute = 0
half = 1
half = 1
end_minute = 45
end_half = 2)
end_half = 2
if(half == 1 & end_half == 1) {
remaining_1st_half = end_minute - minute
} else if(half == 1) { # 1 e 2
remaining_1st_half = 45 - minute
} else if(half == 2) { # 2 e 2
remaining_1st_half = 0
}
if(half == 2 & end_half == 2) {
remaining_2nd_half = end_minute - minute
} else if(end_half == 2) { # 1 e 2
remaining_2nd_half = end_minute
} else if(end_half == 1) { # 1 e 1
remaining_2nd_half = 0
}
remaining = remaining_1st_half + remaining_2nd_half
remaining
gamma = mod_0$gamma
alpha_i = mod_0$alpha[home_team]
mod_0 = mod_0_dc
gamma = mod_0$gamma
alpha_i = mod_0$alpha[home_team]
beta_i = mod_0$beta[home_team]
alpha_j = mod_0$alpha[away_team]
beta_j = mod_0$beta[away_team]
home_goals = NULL
away_goals = NULL
for(g in 1:21) {
home_goals[g] = dpois(g-1, lambda = exp(alpha_i + beta_j + gamma) * remaining/90)
away_goals[g] = dpois(g-1, lambda = exp(alpha_j + beta_i) * remaining/90)
}
home_goals
home_goals = NULL
away_goals = NULL
for(g in 1:21) {
home_goals[g] = dpois(g-1, lambda = exp(alpha_i + beta_j + gamma) * remaining/90)
away_goals[g] = dpois(g-1, lambda = exp(alpha_j + beta_i) * remaining/90)
}
home_goals
exp(alpha_i + beta_j + gamma)
alpha_i
gamma = mod_0$gamma
gamma
mod_0 = mod_0_dc
mod_0_dc
mod_0 = mod_0_dc$`2021-02-25`
pred_mod_0(mod_0, home_team = "Flamengo", away_team = "Fluminense")
pred_mod_0(mod_0, home_team = "Flamengo", away_team = "Fluminense", score_home = 3, score_away = 0)
gamma = mod_0$gamma
alpha_i = mod_0$alpha[home_team]
beta_i = mod_0$beta[home_team]
alpha_j = mod_0$alpha[away_team]
beta_j = mod_0$beta[away_team]
home_goals = NULL
away_goals = NULL
for(g in 1:21) {
home_goals[g] = dpois(g-1, lambda = exp(alpha_i + beta_j + gamma) * remaining/90)
away_goals[g] = dpois(g-1, lambda = exp(alpha_j + beta_i) * remaining/90)
}
home_goals
away_goals
mat_results = home_goals %*% t(away_goals)
rownames(mat_results) = 0:20 + score_home
rownames(mat_results)
score_home
score_home = 3
rownames(mat_results) = 0:20 + score_home
mat_results
0:20 + score_home
pred_mod_0(mod_0, home_team = "Flamengo", away_team = "Fluminense", score_home = 3, score_away = 0)
mod_0 = mod_0_dc$`2021-02-25`
home_team = "Flamengo"
away_team = "Fluminense"
score_home = 3
score_away = 0
minute = 0
half = 1
end_minute = 45
end_half = 2
if(half == 1 & end_half == 1) {
remaining_1st_half = end_minute - minute
} else if(half == 1) { # 1 e 2
remaining_1st_half = 45 - minute
} else if(half == 2) { # 2 e 2
remaining_1st_half = 0
}
if(half == 2 & end_half == 2) {
remaining_2nd_half = end_minute - minute
} else if(end_half == 2) { # 1 e 2
remaining_2nd_half = end_minute
} else if(end_half == 1) { # 1 e 1
remaining_2nd_half = 0
}
remaining = remaining_1st_half + remaining_2nd_half
gamma = mod_0$gamma
alpha_i = mod_0$alpha[home_team]
beta_i = mod_0$beta[home_team]
alpha_j = mod_0$alpha[away_team]
beta_j = mod_0$beta[away_team]
home_goals = NULL
away_goals = NULL
for(g in 1:21) {
home_goals[g] = dpois(g-1, lambda = exp(alpha_i + beta_j + gamma) * remaining/90)
away_goals[g] = dpois(g-1, lambda = exp(alpha_j + beta_i) * remaining/90)
}
home_goals
away_goals
mat_results = home_goals %*% t(away_goals)
mat_results
rownames(mat_results) = 0:20 + score_home
colnames(mat_results) = 0:20 + score_away
View(mat_results)
home_win = sum(mat_results[lower.tri(mat_results)])
away_win = sum(mat_results[upper.tri(mat_results)])
home_win
away_win
mat_results = home_goals %*% t(away_goals)
rownames(mat_results) = 0:20
colnames(mat_results) = 0:20
mat_results
home_goals_2 = NULL
away_goals_2 = NULL
for(g in 1:21) {
home_goals_2[g] = home_goals[g-score_home]
}
for(g in (score_home+1):21) {
home_goals_2[g] = home_goals[g-score_home]
}
home_goals_2
score_home
length(home_goals_12)
length(home_goals_2)
sum(home_goals_2)
home_goals
home_goals_2 = NULL
for(g in (score_home+1):21) {
home_goals_2[g] = home_goals[g-score_home]
}
home_goals_2
for(g in (score_away+1):21) {
away_goals_2[g] = away_goals[g-score_away]
}
away_goals_2
home_goals_2[which(is.na(home_goals_2)] = 0
for(g in (score_away+1):21) {
away_goals_2[g] = away_goals[g-score_away]
}
mat_results = home_goals %*% t(away_goals)
rownames(mat_results) = 0:20
colnames(mat_results) = 0:20
home_win = sum(mat_results[lower.tri(mat_results)])
away_win = sum(mat_results[upper.tri(mat_results)])
draw = 1 - home_win - away_win
winner = c(home_win, draw, away_win)
names(winner) = c(home_team, "Draw", away_team)
freq_scores = NULL
nam = NULL
for(i in 1:21) {
for(j in 1:21) {
freq_scores = c(freq_scores, mat_results[i,j])
nam = c(nam, paste0(rownames(mat_results)[i], "-", rownames(mat_results)[j]))
}
}
names(freq_scores) = nam
freq_scores = sort(freq_scores, decreasing = TRUE)
list("Result" = winner, "Score" = freq_scores)
}
load("~/GitHub/soccer-live-predictions/soccer-live-predictions/weight/data/mod_0_dc.RData")
pred_mod_0(mod_0, home_team = "Flamengo", away_team = "Fluminense", score_home = 3, score_away = 0)
home_goals_2[which(is.na(home_goals_2))] = 0
home_goals_2
away_goals_2[which(is.na(away_goals_2))] = 0
mat_results = home_goals %*% t(away_goals)
rownames(mat_results) = 0:20
colnames(mat_results) = 0:20
View(mat_results)
tmp_hg = NULL
tmp_ag = NULL
home_goals = NULL
away_goals = NULL
for(g in 1:21) {
tmp_hg[g] = dpois(g-1, lambda = exp(alpha_i + beta_j + gamma) * remaining/90)
tmp_ag[g] = dpois(g-1, lambda = exp(alpha_j + beta_i) * remaining/90)
}
for(g in (score_home+1):21) {
home_goals[g] = tmp_hg[g-score_home]
}
home_goals[which(is.na(home_goals))] = 0
for(g in (score_away+1):21) {
away_goals[g] = tmp_ag[g-score_away]
}
away_goals[which(is.na(away_goals))] = 0
mat_results = home_goals %*% t(away_goals)
rownames(mat_results) = 0:20
colnames(mat_results) = 0:20
home_goals
away_goals
pred_mod_0 <- function(mod_0, home_team, away_team, score_home = 0, score_away = 0, minute = 0, half = 1, end_minute = 45, end_half = 2) {
if(half == 1 & end_half == 1) {
remaining_1st_half = end_minute - minute
} else if(half == 1) { # 1 e 2
remaining_1st_half = 45 - minute
} else if(half == 2) { # 2 e 2
remaining_1st_half = 0
}
if(half == 2 & end_half == 2) {
remaining_2nd_half = end_minute - minute
} else if(end_half == 2) { # 1 e 2
remaining_2nd_half = end_minute
} else if(end_half == 1) { # 1 e 1
remaining_2nd_half = 0
}
remaining = remaining_1st_half + remaining_2nd_half
gamma = mod_0$gamma
alpha_i = mod_0$alpha[home_team]
beta_i = mod_0$beta[home_team]
alpha_j = mod_0$alpha[away_team]
beta_j = mod_0$beta[away_team]
tmp_hg = NULL
tmp_ag = NULL
home_goals = NULL
away_goals = NULL
for(g in 1:21) {
tmp_hg[g] = dpois(g-1, lambda = exp(alpha_i + beta_j + gamma) * remaining/90)
tmp_ag[g] = dpois(g-1, lambda = exp(alpha_j + beta_i) * remaining/90)
}
for(g in (score_home+1):21) {
home_goals[g] = tmp_hg[g-score_home]
}
home_goals[which(is.na(home_goals))] = 0
for(g in (score_away+1):21) {
away_goals[g] = tmp_ag[g-score_away]
}
away_goals[which(is.na(away_goals))] = 0
mat_results = home_goals %*% t(away_goals)
rownames(mat_results) = 0:20
colnames(mat_results) = 0:20
home_win = sum(mat_results[lower.tri(mat_results)])
away_win = sum(mat_results[upper.tri(mat_results)])
draw = 1 - home_win - away_win
winner = c(home_win, draw, away_win)
names(winner) = c(home_team, "Draw", away_team)
freq_scores = NULL
nam = NULL
for(i in 1:21) {
for(j in 1:21) {
freq_scores = c(freq_scores, mat_results[i,j])
nam = c(nam, paste0(rownames(mat_results)[i], "-", rownames(mat_results)[j]))
}
}
names(freq_scores) = nam
freq_scores = sort(freq_scores, decreasing = TRUE)
list("Result" = winner, "Score" = freq_scores)
}
load("~/GitHub/soccer-live-predictions/soccer-live-predictions/weight/data/mod_0_dc.RData")
pred_mod_0(mod_0, home_team = "Flamengo", away_team = "Fluminense", score_home = 3, score_away = 0)
pred_mod_0(mod_0, home_team = "Flamengo", away_team = "Fluminense", score_home = 1, score_away = 0)
pred_mod_0(mod_0, home_team = "Flamengo", away_team = "Fluminense", score_home = 1, score_away = 2)
pred_mod_0(mod_0, home_team = "Flamengo", away_team = "Fluminense", score_home = 1, score_away = 5)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/pred/pred_mod_0_v2.R', echo=TRUE)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/weight/predicting_matches_mod_0_dc_v2.R', echo=TRUE)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/weight/HDA_dc_v2.R', echo=TRUE)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/weight/goodness_of_fit_dc_3_v2.R', echo=TRUE)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/weight/csi_mod_0_pred_0_v2.R', echo=TRUE)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/weight/csi_mod_0_pred_0_v2.R', echo=TRUE)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/weight/csi_mod_0_pred_0_v2.R', echo=TRUE)
library(dplyr)
library(ggplot2)
load("data/lst_csi_mod_0_pred_0_v2.RData")
csi = as.numeric(names(lst_csi_mod_0_pred_0))
GeoMean_Results = NULL
GeoMean_Scores = NULL
for(i in 1:length(lst_csi_mod_0_pred_0)) {
GeoMean_Results[i] = lst_csi_mod_0_pred_0[[i]]$GeoMean_Results
GeoMean_Scores[i] = lst_csi_mod_0_pred_0[[i]]$GeoMean_Scores
}
tib_csi = tibble(csi, GeoMean_Results, GeoMean_Scores)
tib_csi %>%
ggplot(aes(x = csi, y = GeoMean_Results)) +
geom_line() +
geom_point() +
theme_bw() +
ylab("Geometric mean for the results")
library(latex2exp)
options(OutDec = ",")
p = tib_csi %>%
ggplot(aes(x = csi, y = GeoMean_Results)) +
geom_line() +
geom_point() +
theme_bw() +
ylab("Média geométrica") +
xlab(TeX("$\\xi$")) +
scale_x_continuous(breaks = c(0, 0.0005, 0.001, 0.0015, 0.002, 0.0025, 0.003, 0.0035, 0.004)) +
geom_vline(xintercept = 0.0065 / 3.5, col = "red")
p
ggsave(filename = "xi.png",
plot = p, width = 10, height = 5, dpi = 1000)
options(OutDec = ".")
tib_csi %>%
ggplot(aes(x = csi, y = GeoMean_Scores)) +
geom_line() +
geom_point() +
theme_bw() +
ylab("Geometric mean for the scores")
tib_csi %>%
arrange(desc(GeoMean_Results))
tib_csi %>%
arrange(desc(GeoMean_Scores))
# Dixon & Coles csi
0.0065 / 3.5
library(dplyr)
library(ggplot2)
load("data/lst_csi_mod_0_pred_0_v2.RData")
csi = as.numeric(names(lst_csi_mod_0_pred_0))
csi
View(lst_csi_mod_0_pred_0)
lst_csi_mod_0_pred_0
names(lst_csi_mod_0_pred_0)
csi = seq(from = 0, to = 0.004, by = 0.0001)
csi
GeoMean_Results = NULL
GeoMean_Scores = NULL
for(i in 1:length(lst_csi_mod_0_pred_0)) {
GeoMean_Results[i] = lst_csi_mod_0_pred_0[[i]]$GeoMean_Results
GeoMean_Scores[i] = lst_csi_mod_0_pred_0[[i]]$GeoMean_Scores
}
tib_csi = tibble(csi, GeoMean_Results, GeoMean_Scores)
tib_csi %>%
ggplot(aes(x = csi, y = GeoMean_Results)) +
geom_line() +
geom_point() +
theme_bw() +
ylab("Geometric mean for the results")
library(latex2exp)
options(OutDec = ",")
p = tib_csi %>%
ggplot(aes(x = csi, y = GeoMean_Results)) +
geom_line() +
geom_point() +
theme_bw() +
ylab("Média geométrica") +
xlab(TeX("$\\xi$")) +
scale_x_continuous(breaks = c(0, 0.0005, 0.001, 0.0015, 0.002, 0.0025, 0.003, 0.0035, 0.004)) +
geom_vline(xintercept = 0.0065 / 3.5, col = "red")
p
ggsave(filename = "xi.png",
plot = p, width = 10, height = 5, dpi = 1000)
options(OutDec = ".")
tib_csi %>%
ggplot(aes(x = csi, y = GeoMean_Scores)) +
geom_line() +
geom_point() +
theme_bw() +
ylab("Geometric mean for the scores")
tib_csi %>%
arrange(desc(GeoMean_Results))
tib_csi %>%
arrange(desc(GeoMean_Scores))
# Dixon & Coles csi
0.0065 / 3.5
p = tib_csi %>%
ggplot(aes(x = csi, y = GeoMean_Scores)) +
geom_line() +
geom_point() +
theme_bw() +
ylab("Média geométrica") +
xlab(TeX("$\\xi$")) +
scale_x_continuous(breaks = c(0, 0.0005, 0.001, 0.0015, 0.002, 0.0025, 0.003, 0.0035, 0.004)) +
geom_vline(xintercept = 0.0065 / 3.5, col = "red")
p
ggsave(filename = "xi.png",
plot = p, width = 10, height = 5, dpi = 1000)
options(OutDec = ".")
library(dplyr)
library(ggplot2)
load("data/lst_csi_mod_0_pred_0_v2.RData")
csi = seq(from = 0, to = 0.004, by = 0.0001)
GeoMean_Results = NULL
GeoMean_Scores = NULL
for(i in 1:length(lst_csi_mod_0_pred_0)) {
GeoMean_Results[i] = lst_csi_mod_0_pred_0[[i]]$GeoMean_Results
GeoMean_Scores[i] = lst_csi_mod_0_pred_0[[i]]$GeoMean_Scores
}
tib_csi = tibble(csi, GeoMean_Results, GeoMean_Scores)
tib_csi %>%
ggplot(aes(x = csi, y = GeoMean_Results)) +
geom_line() +
geom_point() +
theme_bw() +
ylab("Geometric mean for the results")
library(latex2exp)
options(OutDec = ",")
p = tib_csi %>%
ggplot(aes(x = csi, y = GeoMean_Results)) +
geom_line() +
geom_point() +
theme_bw() +
ylab("Média geométrica") +
xlab(TeX("$\\xi$")) +
scale_x_continuous(breaks = c(0, 0.0005, 0.001, 0.0015, 0.002, 0.0025, 0.003, 0.0035, 0.004)) +
geom_vline(xintercept = 0.0065 / 3.5, col = "red")
p
ggsave(filename = "xi.png",
plot = p, width = 10, height = 5, dpi = 1000)
options(OutDec = ".")
p = tib_csi %>%
ggplot(aes(x = csi, y = GeoMean_Scores)) +
geom_line() +
geom_point() +
theme_bw() +
ylab("Média geométrica") +
xlab(TeX("$\\xi$")) +
scale_x_continuous(breaks = c(0, 0.0005, 0.001, 0.0015, 0.002, 0.0025, 0.003, 0.0035, 0.004)) +
geom_vline(xintercept = 0.0065 / 3.5, col = "red")
p
ggsave(filename = "xi2.png",
plot = p, width = 10, height = 5, dpi = 1000)
options(OutDec = ".")
tib_csi %>%
arrange(desc(GeoMean_Results))
tib_csi %>%
arrange(desc(GeoMean_Scores))
# Dixon & Coles csi
0.0065 / 3.5
library(dplyr)
library(ggplot2)
load("data/lst_csi_mod_0_pred_0_v2.RData")
csi = seq(from = 0, to = 0.004, by = 0.0001)
GeoMean_Results = NULL
GeoMean_Scores = NULL
for(i in 1:length(lst_csi_mod_0_pred_0)) {
GeoMean_Results[i] = lst_csi_mod_0_pred_0[[i]]$GeoMean_Results
GeoMean_Scores[i] = lst_csi_mod_0_pred_0[[i]]$GeoMean_Scores
}
tib_csi = tibble(csi, GeoMean_Results, GeoMean_Scores)
tib_csi %>%
ggplot(aes(x = csi, y = GeoMean_Results)) +
geom_line() +
geom_point() +
theme_bw() +
ylab("Geometric mean for the results")
library(latex2exp)
options(OutDec = ",")
p = tib_csi %>%
ggplot(aes(x = csi, y = GeoMean_Results)) +
geom_line() +
geom_point() +
theme_bw() +
ylab("Média geométrica") +
xlab(TeX("$\\xi$")) +
scale_x_continuous(breaks = c(0, 0.0005, 0.001, 0.0015, 0.002, 0.0025, 0.003, 0.0035, 0.004)) +
geom_vline(xintercept = 0.0065 / 3.5, col = "red")
p
ggsave(filename = "xi.png",
plot = p, width = 10, height = 5, dpi = 1000)
p = tib_csi %>%
ggplot(aes(x = csi, y = GeoMean_Scores)) +
geom_line() +
geom_point() +
theme_bw() +
ylab("Média geométrica") +
xlab(TeX("$\\xi$")) +
scale_x_continuous(breaks = c(0, 0.0005, 0.001, 0.0015, 0.002, 0.0025, 0.003, 0.0035, 0.004)) +
geom_vline(xintercept = 0.0065 / 3.5, col = "red")
p
ggsave(filename = "xi2.png",
plot = p, width = 10, height = 5, dpi = 1000)
tib_csi %>%
arrange(desc(GeoMean_Results))
tib_csi %>%
arrange(desc(GeoMean_Scores))
# Dixon & Coles csi
0.0065 / 3.5
