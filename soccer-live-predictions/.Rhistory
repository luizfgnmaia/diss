colnames(tab_results) = c("Home", "Draw", "Away")
colnames(tab_home_goals) = c(0:4, "5+")
colnames(tab_away_goals) = c(0:4, "5+")
# save.image("weight/data/goodness_of_fit_dc.RData")
?dmultinom
dmultinom(x = 1, size = 1, prob = c(0.5, 0.3, 0.2))
dmultinom(x = c(1, 0, 0), size = 1, prob = c(0.5, 0.3, 0.2))
dmultinom(x = c(0, 1, 0), size = 1, prob = c(0.5, 0.3, 0.2))
predictions_mod_0_dc
loglik_results = NULL
loglik_scores = NULL
loglik_results = NULL
loglik_scores = NULL
loglik_results_observed = NULL
loglik_scores_observed = NULL
loglik_results_mod_0 = NULL
loglik_scores_mod_0 = NULL
loglik_results_observed_mod_0 = NULL
loglik_scores_observed_mod_0 = NULL
loglik_results_mod_3 = NULL
loglik_scores_mod_3 = NULL
loglik_results_observed_mod_3 = NULL
loglik_scores_observed_mod_3 = NULL
sample(predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[1]]$pred_0$Result)
sample(predictions_mod_0_dc[[1]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[1]]$pred_0$Result)
i=1
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
pnk_Result <- function(Result, pH, pD, pA) {
p = c(pH, pD, pA)
p[Result]
}
pnk_Score <- function(Score, Match) {
event = paste0(Match$Score_Home, "-", Match$Score_Away)
p = Score[event]
ifelse(is.na(p), 0, p)
}
pnk_Result(predictions_mod_0_dc[[i]]$Match$Match)
predictions_mod_0_dc[[i]]$Match$Match
predictions_mod_0_dc[[i]]$Match$Match
predictions_mod_0_dc[[i]]$Match
predictions_mod_0_dc[[i]]$Result
predictions_mod_0_dc[[i]]$pred_0$Result
pnk_Result <- function(Result, Match) {
res = ifelse(Match$Score_Home > Match$Score_Away, 1,
ifelse(Match$Score_Home == Match$Score_Away, 2,
3))
Result[res]
}
pnk_Score <- function(Score, Match) {
event = paste0(Match$Score_Home, "-", Match$Score_Away)
p = Score[event]
ifelse(is.na(p), 0, p)
}
sim_all_matches <- function() {
loglik_results_mod_0 = NULL
loglik_scores_mod_0 = NULL
loglik_results_mod_3 = NULL
loglik_scores_mod_3 = NULL
for(i in 1:length(predictions_mod_0_dc)) {
loglik_results_mod_0[i] = log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
loglik_scores_mod_0[i] = log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
loglik_results_mod_3[i] = log(sample(predictions_mod_3_dc[[i]]$pred_3$Result, size = 1, prob = predictions_mod_3_dc[[i]]$pred_3$Result))
loglik_scores_mod_3[i] = log(sample(predictions_mod_3_dc[[i]]$pred_3$Score, size = 1, prob = predictions_mod_3_dc[[i]]$pred_3$Score))
}
list(loglik_results_mod_0 = sum(loglik_results_mod_0),
loglik_scores_mod_0 = sum(loglik_scores_mod_0),
loglik_results_mod_3 = sum(loglik_results_mod_3),
loglik_scores_mod_3 = sum(loglik_scores_mod_3))
}
sim_all_matches()
sim_all_matches()
sim_all_matches()
sim_all_matches()
sim_all_matches()
sim_all_matches()
sim_all_matches()
sim_all_matches()
sim_all_matches()
sim_all_matches()
loglik_observed_results_mod_0 = NULL
loglik_observed_scores_mod_0 = NULL
loglik_observed_results_mod_3 = NULL
loglik_observed_scores_mod_3 = NULL
pnk_Result(predictions_mod_0_dc[[i]]$pred_0$Result, predictions_mod_0_dc[[i]]$Match)
pnk_Result(predictions_mod_0_dc[[i]]$pred_0$Result, predictions_mod_0_dc[[i]]$Match)
pnk_Result(predictions_mod_0_dc[[i]]$pred_0$Result, predictions_mod_0_dc[[i]]$Match)
pnk_Result(predictions_mod_0_dc[[i]]$pred_0$Result, predictions_mod_0_dc[[i]]$Match)
pnk_Result(predictions_mod_0_dc[[i]]$pred_0$Result, predictions_mod_0_dc[[i]]$Match)
pnk_Result(predictions_mod_0_dc[[i]]$pred_0$Result, predictions_mod_0_dc[[i]]$Match)
i
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
loglik_observed_results_mod_0 = NULL
loglik_observed_scores_mod_0 = NULL
loglik_observed_results_mod_3 = NULL
loglik_observed_scores_mod_3 = NULL
for(i in 1:length(predictions_mod_0_dc)) {
loglik_observed_results_mod_0[i] = log(pnk_Result(predictions_mod_0_dc[[i]]$pred_0$Result, predictions_mod_0_dc[[i]]$Match))
loglik_observed_scores_mod_0[i] = log(pnk_Score(predictions_mod_0_dc[[i]]$pred_0$Score, predictions_mod_0_dc[[i]]$Match))
loglik_observed_results_mod_3[i] = log(pnk_Result(predictions_mod_3_dc[[i]]$pred_0$Result, predictions_mod_3_dc[[i]]$Match))
loglik_observed_scores_mod_3[i] = log(pnk_Score(predictions_mod_3_dc[[i]]$pred_0$Score, predictions_mod_3_dc[[i]]$Match))
}
loglik_observed_results_mod_0 = sum(loglik_observed_results_mod_0)
loglik_observed_scores_mod_0 = sum(loglik_observed_scores_mod_0)
loglik_observed_results_mod_3 = sum(loglik_observed_results_mod_3)
loglik_observed_scores_mod_3 = sum(loglik_observed_scores_mod_3)
loglik_observed_results_mod_0
loglik_observed_results_mod_3
loglik_observed_results_mod_3
loglik_observed_scores_mod_0
loglik_observed_scores_mod_3
# Função para simular todas as partidas previstas
sim_all_matches <- function() {
loglik_results_mod_0 = NULL
loglik_scores_mod_0 = NULL
loglik_results_mod_3 = NULL
loglik_scores_mod_3 = NULL
for(i in 1:length(predictions_mod_0_dc)) {
loglik_results_mod_0[i] = log(sample(predictions_mod_0_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Result))
loglik_scores_mod_0[i] = log(sample(predictions_mod_0_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_0_dc[[i]]$pred_0$Score))
loglik_results_mod_3[i] = log(sample(predictions_mod_3_dc[[i]]$pred_0$Result, size = 1, prob = predictions_mod_3_dc[[i]]$pred_0$Result))
loglik_scores_mod_3[i] = log(sample(predictions_mod_3_dc[[i]]$pred_0$Score, size = 1, prob = predictions_mod_3_dc[[i]]$pred_0$Score))
}
list(loglik_results_mod_0 = sum(loglik_results_mod_0),
loglik_scores_mod_0 = sum(loglik_scores_mod_0),
loglik_results_mod_3 = sum(loglik_results_mod_3),
loglik_scores_mod_3 = sum(loglik_scores_mod_3))
}
apply(1:10, sim_all_matches)
apply(1:10, sim_all_matches())
apply(1:10, sim_all_matches())
sapply(1:10, sim_all_matches)
sapply(1:10, sim_all_matches())
sim_all_matches()
sim_all_matches()
sim_all_matches()
?sapply
sapply(c(1:10), mean)
sapply(c(1:10), simulate_all_matches)
lapply(c(1:10), simulate_all_matches)
lapply(c(1:10), simulate_all_matches())
lapply(c(1:10), sim_all_matches())
sim = sim_all_matches()
sim_all_matches_n <- function(n) {
log_lik_results_mod_0 = NULL
log_lik_scores_mod_0 = NULL
log_lik_results_mod_3 = NULL
log_lik_scores_mod_3 = NULL
for(i in 1:n) {
sim = sim_all_matches()
log_lik_results_mod_0[[i]] = sim$loglik_results_mod_0
log_lik_scores_mod_0[[i]] = sim$loglik_results_mod_0
log_lik_results_mod_3[[i]] = sim$loglik_scores_mod_3
log_lik_scores_mod_3[[i]] = sim$loglik_scores_mod_3
}
list(loglik_results_mod_0 = loglik_results_mod_0,
loglik_scores_mod_0 = loglik_scores_mod_0,
loglik_results_mod_3 = loglik_results_mod_3,
loglik_scores_mod_3 = loglik_scores_mod_3)
}
sim_all_matches_n <- function(n) {
log_lik_results_mod_0 = NULL
log_lik_scores_mod_0 = NULL
log_lik_results_mod_3 = NULL
log_lik_scores_mod_3 = NULL
for(i in 1:n) {
sim = sim_all_matches()
log_lik_results_mod_0[[i]] = sim$loglik_results_mod_0
log_lik_scores_mod_0[[i]] = sim$loglik_results_mod_0
log_lik_results_mod_3[[i]] = sim$loglik_scores_mod_3
log_lik_scores_mod_3[[i]] = sim$loglik_scores_mod_3
print(paste0(round(100*i/n, 2), "%"))
}
list(loglik_results_mod_0 = loglik_results_mod_0,
loglik_scores_mod_0 = loglik_scores_mod_0,
loglik_results_mod_3 = loglik_results_mod_3,
loglik_scores_mod_3 = loglik_scores_mod_3)
}
sims = sim_all_matches_n(10^5)
sims = sim_all_matches_n(10^4)
sims
sims = sim_all_matches_n(10^2)
sims$loglik_results_mod_0
sims
sim_all_matches_n <- function(n) {
ret_results_mod_0 = NULL
ret_scores_mod_0 = NULL
ret_results_mod_3 = NULL
ret_scores_mod_3 = NULL
for(i in 1:n) {
sim = sim_all_matches()
ret_results_mod_0[[i]] = sim$loglik_results_mod_0
ret_scores_mod_0[[i]] = sim$loglik_results_mod_0
ret_results_mod_3[[i]] = sim$loglik_scores_mod_3
ret_scores_mod_3[[i]] = sim$loglik_scores_mod_3
print(paste0(round(100*i/n, 2), "%"))
}
list(loglik_results_mod_0 = ret_results_mod_0,
loglik_scores_mod_0 = ret_scores_mod_0,
loglik_results_mod_3 = ret_results_mod_3,
loglik_scores_mod_3 = ret_scores_mod_3)
}
sim_all_matches(10)
sim_all_matches_n(10)
sim_all_matches_n <- function(n) {
ret_results_mod_0 = NULL
ret_scores_mod_0 = NULL
ret_results_mod_3 = NULL
ret_scores_mod_3 = NULL
for(i in 1:n) {
sim = sim_all_matches()
ret_results_mod_0[i] = sim$loglik_results_mod_0
ret_scores_mod_0[i] = sim$loglik_results_mod_0
ret_results_mod_3[i] = sim$loglik_scores_mod_3
ret_scores_mod_3[i] = sim$loglik_scores_mod_3
print(paste0(round(100*i/n, 2), "%"))
}
list(loglik_results_mod_0 = ret_results_mod_0,
loglik_scores_mod_0 = ret_scores_mod_0,
loglik_results_mod_3 = ret_results_mod_3,
loglik_scores_mod_3 = ret_scores_mod_3)
}
sim_all_matches_n(10)
exp(-1874.855)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/weight/goodness_of_fit_dc.R', encoding = 'UTF-8', echo=TRUE)
sims[[1]]
names(sims)
sims$loglik_results_mod_0
hist(sims[[1]])
loglik_observed_results_mod_0
library(ggplot2)
library(knitr)
library(ggplot2)
load("data/goodness_of_fit_dc.RData")
tibble(x = sims[[1]]) %>%
ggplot(aes(x = x)) +
geom_histogram()
tibble(x = sims[[1]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 30)
tibble(x = sims[[1]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 30) +
theme_bw()
tibble(x = sims[[1]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw()
tibble(x = sims[[1]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_results_mod_0)
tibble(x = sims[[1]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_results_mod_0, col = "red")
names(sim)
names(sims)
tibble(x = sims[[]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_results_mod_0, col = "red") +
xlab("Scores model 0")
tibble(x = sims[[1]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_results_mod_0, col = "red") +
xlab("Scores model 0")
tibble(x = sims[[1]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_results_mod_0, col = "red") +
xlab("Log-likelihood") +
ylab("Count") +
ggtitle("Results model 0")
names(sims)
tibble(x = sims[[2]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_scores_mod_0, col = "red") +
xlab("Log-likelihood") +
ylab("Count") +
ggtitle("Scores model 0")
scores_model_0
loglik_observed_scores_mod_0
tibble(x = sims[[3]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_results_mod_3, col = "red") +
xlab("Log-likelihood") +
ylab("Count") +
ggtitle("Results model 3")
tibble(x = sims[[4]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_scores_mod_3, col = "red") +
xlab("Log-likelihood") +
ylab("Count") +
ggtitle("Scores model 3")
names(sims)
library(knitr)
library(ggplot2)
load("data/goodness_of_fit_dc.RData")
kable(tab_results, digits = 4)
kable(tab_home_goals, digits = 4)
kable(tab_away_goals, digits = 4)
tibble(x = sims[[1]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_results_mod_0, col = "red") +
xlab("Log-likelihood") +
ylab("Count") +
ggtitle("Results model 0")
library(knitr)
library(dplyr)
library(ggplot2)
load("data/goodness_of_fit_dc.RData")
kable(tab_results, digits = 4)
kable(tab_home_goals, digits = 4)
kable(tab_away_goals, digits = 4)
tibble(x = sims[[1]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_results_mod_0, col = "red") +
xlab("Log-likelihood") +
ylab("Count") +
ggtitle("Results model 0")
tibble(x = sims[[2]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_scores_mod_0, col = "red") +
xlab("Log-likelihood") +
ylab("Count") +
ggtitle("Scores model 0")
tibble(x = sims[[3]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_results_mod_3, col = "red") +
xlab("Log-likelihood") +
ylab("Count") +
ggtitle("Results model 3")
tibble(x = sims[[4]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_scores_mod_3, col = "red") +
xlab("Log-likelihood") +
ylab("Count") +
ggtitle("Scores model 3")
sims
sims[1]
sims[]
sims[2]
sims[3]
sims[4]
sims[3]
sims[4]
sims[3]
sims[4]
sims[3]
sims[4]
sims[3]
sims[4]
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/weight/goodness_of_fit_dc.R', encoding = 'UTF-8', echo=TRUE)
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/weight/goodness_of_fit_dc.R', encoding = 'UTF-8', echo=TRUE)
library(knitr)
library(dplyr)
library(ggplot2)
load("data/goodness_of_fit_dc.RData")
kable(tab_results, digits = 4)
kable(tab_home_goals, digits = 4)
kable(tab_away_goals, digits = 4)
tibble(x = sims[["loglik_results_mod_0"]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_results_mod_0, col = "red") +
xlab("Log-likelihood") +
ylab("Count") +
ggtitle("Results model 0")
sum(sims[["loglik_results_mod_0"]] <= loglik_observed_results_mod_0)
sum(sims[["loglik_results_mod_0"]] <= loglik_observed_results_mod_0) / length(sims[["loglik_results_mod_0"]])
sum(sims[["loglik_scores_mod_0"]] <= loglik_observed_scores_mod_0) / length(sims[["loglik_scores_mod_0"]])
tibble(x = sims[["loglik_scores_mod_0"]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_scores_mod_0, col = "red") +
xlab("Log-likelihood") +
ylab("Count") +
ggtitle("Scores model 0")
sum(sims[["loglik_scores_mod_0"]] >= loglik_observed_scores_mod_0) / length(sims[["loglik_scores_mod_0"]])
tibble(x = sims[["loglik_results_mod_3"]]) %>%
ggplot(aes(x = x)) +
geom_histogram(bins = 50) +
theme_bw() +
geom_vline(xintercept = loglik_observed_results_mod_3, col = "red") +
xlab("Log-likelihood") +
ylab("Count") +
ggtitle("Results model 3")
sum(sims[["loglik_results_mod_0"]] <= loglik_observed_results_mod_3) / length(sims[["loglik_results_mod_3"]])
sum(sims[["loglik_results_mod_3"]] <= loglik_observed_results_mod_3) / length(sims[["loglik_results_mod_3"]])
sum(sims[["loglik_scores_mod_3"]] <= loglik_observed_scores_mod_3) / length(sims[["loglik_scores_mod_3"]])
source('~/GitHub/soccer-live-predictions/soccer-live-predictions/weight/goodness_of_fit_dc.R', echo=TRUE)
